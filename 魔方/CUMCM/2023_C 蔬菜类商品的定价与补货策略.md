>[!note] 论文提醒
>1. 可以在每一问前画出一张流程图，建议使用visio。
>2. 将变量列到一张表中。
>3. 每一步操作的代码都被链接在‘***MATLAB中进行处理***' 中，点击即可查阅。
>4. 有具体操作名称的链接是对这种方法的总结，可以看看了解一下。例如’***一、数据预处理***‘中的定值插值。


## 一、数据预处理

由于所给数据按照交易发生时间排列，不利于品类与单品的时序分析与预测，我们对数据进行了处理，将其按照品类与单品的日销量排列。并通过[定值插值](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=%E5%BB%BA%E6%A8%A1%2F%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E4%B8%8E%E5%A4%84%E7%90%86%2F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86)的方法填补了缺失值，使数据更加平滑，便于分析。

## 二、第一问

### 品类的分析
结合经济学的理论，蔬菜作为必需品的一种，具有强烈的周期性特点；同时，由于其市场最接近自由竞争类市场，因此具有充分的产品互补性，体现在数学上表现为两种产品之间的强关联关系。为了更好突出数据特点，对于蔬菜的周期性特点，我们通过绘制销量图分析；对于蔬菜的产品互补性特点，我们使用spearman关联性分析进行阐述。

#### 对于周期性的分析
通过[[2023_C 蔬菜类商品的定价与补货策略#一、数据预处理|数据预处理]] 我们已经得到了比较完整的各品类日销量数据，将这些[[数据导入]][MATLAB中进行处理](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=CUMCM%2FCUMCM%20%E4%BB%A3%E7%A0%81%2F(%E8%94%AC%E8%8F%9C%E6%95%B0%E6%8D%AE))，得到各品类相关销量图。这里使用花叶、花菜、水生根茎类作为示例：

![[整体销量.png]]
 通过对蔬菜品类销量数据的分析，可以发现这些品类在季度尺寸上呈现出一定的周期性，整体表现为波浪式特点。这一现象表明季节变化对蔬菜品类销量具有显著的关联性。初步推测应该是由于季节对蔬菜生产的影响导致的.



同时,我们对该图进行局部分析,得到：

![[1.png]]
![[2.png]]
![[3.png]]

![[4.png]]
>[!note] 论文建议
>将上文中四个以周为尺度的图拼为一张图

通过观察发现，在国际标准周的时间尺度上，品类的销量呈现出明显的周期性。我们推测，这可能与人们的日常生活习惯密切相关。例如，由于工作日较为忙碌，人们通常会在周末集中采购蔬菜，以满足一周的饮食需求，这种消费模式可能是导致销量周期性变化的重要因素之一。


最后，借助MATLAB软件进行数据分析，我们能够提取出各品类销量的数据特征。


|       | 偏度    | 峰度     | 最大值      | 最小值    | 平均值     |
| ----- | ----- | ------ | -------- | ------ | ------- |
| 花叶类   | 2.901 | 26.216 | 1265.473 | 31.298 | 182.969 |
| 花菜类   | 1.528 | 4.206  | 186.155  | 0.632  | 38.53   |
| 水生根茎类 | 2.508 | 12.162 | 296.792  | 0.926  | 37.402  |
| 茄类    | 1.738 | 5.89   | 118.931  | 0.252  | 21.364  |
| 辣椒类   | 3.146 | 18.42  | 604.231  | 6.066  | 84.413  |
| 食用菌类  | 2.996 | 16.896 | 511.136  | 3.012  | 70.126  |
- 花叶类的销量数据具有最高的最大值和平均值，说明花叶类的销量整体较高，且存在一些极高的销量值。
- 花菜类的销量数据具有最低的最大值和平均值，说明花菜类的销量整体较低，且没有出现极高的销量值。
- 水生根茎类的销量数据具有最高的最小值，说明水生根茎类的销量即使在最低时也相对较高。- 辣椒类和食用菌类的销量数据具有较高的偏度和峰度，说明这两个品类的销量分布存在更多的极端值。

>[!NOTE]  论文建议
>根据这个数据分析再得出一个简单结论，建议从各品类蔬菜的特性、中国人的日常饮食、传统节日等因素分析。


#### 对于互补性的分析
鉴于蔬菜产品互补性的特点，各品类之间应存在成对关联。基于此，我们[使用spearman分析](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=%E5%BB%BA%E6%A8%A1%2F%E5%9F%BA%E6%9C%AC%E7%AE%97%E6%B3%95%2FSpearman%E5%88%86%E6%9E%90)，[将数据导入MATLAB进行处理](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=CUMCM%2FCUMCM%20%E4%BB%A3%E7%A0%81%2Fspearman%E5%88%86%E6%9E%90%E4%BB%A3%E7%A0%81)(代码），得到热力图：


![[热力图.png]]

酌情分析（大于0表示正相关，此时表面品类互为互补品；小于0表示负相关，此时互为替代品）
>[!NOTE] 论文建议
>说一下哪些是互补哪些是替代? 对其互补性与替代性作简要分析。

### 单品的分析

对于单品，我们采用与品类不同的分析策略，通过[[#一、数据预处理]]，我们已经得到了各单品蔬菜的销量数据，在日常生活中，商超通常将蔬菜分为畅销，热销，平销，滞销四个种类，为了贴合实际，我们也通过[Kmeans聚类分析](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=%E5%BB%BA%E6%A8%A1%2F%E5%9F%BA%E6%9C%AC%E7%AE%97%E6%B3%95%2FKmeans%E8%81%9A%E7%B1%BB%E5%88%86%E6%9E%90)，设定K = 4，分别表示这四种蔬菜类别，并将结果储存在’***2023c\第一问\品类\蔬菜类别.xlsx***‘中。

其中，类别4是畅销，2是热销，3是平销，1是滞销。
>[!note] 论文建议
>聚类图删掉改成表格（使用***2023c\第一问\品类\蔬菜类别.xlsx***中的数据）
## 三、第二问
### 第一小问
要求我们分析销量与加成定价之间的关系，从需求端而言，蔬菜作为生活必需品，拥有较低的需求弹性，在数学上表现为较平直的销售曲线；从生产端而言，我国的蔬菜产业大部分为规模经济，这就导致大量的同类蔬菜产品稀释了其固定成本，这就导致单位产品的成本几乎是固定的，增加销量通常不会显著增加单位成本，这使得总成本随销量增加而线性增加。
基于上述分析，我们采用一次函数来表示成本与加成定价之间的关系，通过基本的[[数据拟合#^f94c23]]就可以得到它们之间的关系([代码](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=CUMCM%2FCUMCM%20%E4%BB%A3%E7%A0%81%2F%E8%94%AC%E8%8F%9C%E6%95%B0%E6%8D%AE%E6%8B%9F%E5%90%88)）。
- **食用菌****：**Y = 9.482-0.013*x^1

- **辣椒类****：**Y = 9.674-0.012*x^1

- **茄类****：**Y = 9.595-0.036*x^1

- **水生根茎类****：**Y = 11.294-0.042*x^1

- **花菜类****：**Y = 10.661-0.032*x^1

- **花叶类****：**Y = 6.353-0.004*x^1

### 第二小问
题目要求我们给出各蔬菜品类未来一周(2023 年 7 月 1-7 日)的日补货总量和定价策略， 使得商超收益最大。
为了给出各蔬菜品类未来一周（2023年7月1-7日）的日补货总量和定价策略，以使商超收益最大化，我们提出以下假设:
1. 商超无法准确的知晓每天的销量，只能通过预测出的数据进行采购。
2. 由于使用了科学的预测方法，每天的实际销量以预测出的销量为基准上下波动。
3. 销量与价格之间存在线性关系，并且这种关系是已知的。
4. 商超在知晓实际销量大于进货量时，会调高价格，但以全部售出为底线，以防止产生其他费用

为此，我们使用仿真实验模拟商超销售蔬菜。首先使用***SARIMA（季节性时间序列预测）***‘预测蔬菜销量，并引入Bertsimas 和 Dimitris提出的’***预算不确定集***‘模拟实际销量，接着通过’***遗传算法***‘进行求解，最后进行’***鲁棒检验***‘，分析模型效果。

#### SARIMA预测蔬菜销量
由于蔬菜销量具有明显的季节性，周期性特点，我们没有使用传统的时间序列预测模型，而是采用了更适合季节性预测的[改进型季节性时间序列（SARIMA）](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=%E5%BB%BA%E6%A8%A1%2F%E5%9F%BA%E6%9C%AC%E7%AE%97%E6%B3%95%2FSARIMA%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B)预测模型进行预测。
为了确定SARIMA各项参数，我们需要对数据进行分析，以下以花叶类为例进行分析。
首先，为了确定ACF与PACF图的平滑参数，我们需要对序列图进行分析，首先，我们画出一次平滑序列图（1,1）。
![[时序图11.png]]
可以发现，在一次平滑下，序列图中依然存在一些影响较大的噪声，因此，我们使用二次平滑序列图（2,1）进行分析。
![[Pasted image 20250113125232.png]]
>[!note] 论文建议
>能不能把图(2,1)中的函数线换一个颜色放在图（1,1）中（使用ps软件）,这样体现对称的程度。

在二次平滑序列图中，我们分析数据==较为对称==，这说明噪声在二次平滑的情况下对数据影响较少，因此，我们采用二次平滑自相关系数。

在确定平滑系数后，我们画出二次平滑自相关（ACF)与偏自相关图(PACF)，并通过其确定SARIMA中的参数。
![[Pasted image 20250113125857.png]]



![[Pasted image 20250113125957.png]]
>[!note] 论文建议
>可以看看上文中‘***改进型季节性时间序列（SARIMA）***’中的链接，了解如何通过ACF与PACF图判断参数，然后在论文中加以阐释。


通过观察两图中的显著性滞后数据，我们最终将参数确定为SARIMA（1,1,1）（1,1,7）。
并预测出可能销量。保存在"2023c\第二问\第二小问\六大类预测数据.xlsx"中。

![[Pasted image 20250113131113.png]]

![[预测图.png]]
>[!note] 论文建议
>可以将这几个图放在正文，也可以放在附录，依美观而定。

#### 构建预算不确定集
在制定补货计划时，由于市场变化和客户的个性化需求，决策者无法准确预知需求的产生。为了应对这种不确定性，我们采用Bertsimas和Sim提出的预算不确定集（Budgeted Uncertainty Set）来表述需求的不确定性。假设每个产品每个周期的需求 ⅆ𝑗𝑡 都属于如下的预算不确定集 DjtBDjtB​ 中
![[QianJianTec1736745424396.png]]

```LaTeX代码
D_{j t}^{B}=\left\{d_{j t}\left|d_{j t}=\bar{d}_{j t}+z_{j t} \tilde{d}_{j t}, \quad-1 \leq z_{j t} \leq 1, \quad \sum_{t=1}^{T}\right| z_{j t} \mid \leq \Gamma_{t}\right\}
```

其中ⅆ̅ 𝑡是不确定集中的需求标称值，ⅆ̃是最大需求偏差值，决定了不确定集合 的上下限，𝑧𝑡是需求扰动控制参数，表示需求的偏离程度，𝛤𝑡是引入的限制参数， 也是预算不确定集合里的“预算”，起限制不确定集的作用，刻画了整个集合的保 守度。例如当𝛤𝑡 = 0，此时的|𝑧𝑗𝑡 | = 0，ⅆ𝑗𝑡 = ⅆ̅ 𝑗𝑡，不确定集合等于标称值；当𝛤𝑡 =  𝑇，此时的|𝑧𝑗𝑡 | = 1，不确定集合的鲁棒性最强，但保守度也最高，集合允许每个周 期的需求同时处于最差情况。

在本题中，ⅆ̅ 𝑡就是预测出的蔬菜销量，ⅆ̃设置为预测销量的30%，𝑧𝑡是均值为0，方差为0.5的正态分布函数，𝛤𝑡 =  𝑇。因此，我们构建出了关于蔬菜销量的需求不确定集。

#### 构建模型
通过查阅文献，我们找到了各品类蔬菜售价与销量的关系：
辣 椒类日销 售 量 每 上 升 1kg,其 成 本 加 成 定 价 则 降 低 0.04元;食用菌类日销售量每上升1kg,其成本加成定 价则降低0.05元，花菜类、茄类、花叶类和水生根茎类，当其销量每增加1kg时,成本加成定价分别减少0.09、0.06、0.09和 0.03元。
>[!note] 论文建议
>将蔬菜售价与销量的关系列个表。

我们设蔬菜与销量的梯度关系为G, djt 为预计售价下的实际销量，ⅆ̅ 𝑡为预测销量，预测售价为Sp，售价为x, 则售价与销量（y)的关系为：

![[Pasted image 20250113140021.png]]
```latex
y=d_{jt}-\frac{(X-S_{p})}{G}
```


同时，通过所给数据得出各品类蔬菜的平均成本，设为C，则总公式为：

![[Pasted image 20250113140646.png]]
```latex
\max z=x\cdot(d_{jt}-\frac{(x-S_{p})}{G})-c\cdot d_{t}
```

在制定补货和定价策略时，我们首先假设每天的订货量等于预测的销售量。基于此，我们通过调整售价来实现最大利润。这一假设与实际情况相符，因为商超无法预知未来，只能依据预测数据进行决策。具体来说，商超的定价策略取决于实际销量与订货量之间的关系，我们可以通过以下分类讨论来详细阐述：



1. 实际销量大于订货量
当实际销量 djt 大于订货量 xjt时，商超会调高价格，以确保所有商品都能售出。如果继续提高价格，可能会导致部分商品剩余，从而产生额外的库存成本和其他费用，这是不经济的。因此，当实际销量大于订货量时，商超的销售价 x​ 应调整为正好卖完的价格。
2. 实际销量小于订货量
当实际销量 djt 小于订货量 xjt 时，商超可能会选择调低或调高价格。由于其他费用（如库存成本、处理费用等）已经产生，商超的目标是尽可能弥补这些损失。具体策略如下：

- **调低价格**：通过降低价格，增加销量，减少库存剩余，从而降低库存成本和其他费
- **调高价格**：如果市场需求弹性较小，调高价格可能会增加单位商品的利润，尽管销量减少，但总收入可能增加。


通过讨论，我们得到约束条件：
- 当该品类蔬菜实际销量大于订货量
 ![[Pasted image 20250113142034.png]]
 ```latex
 X=G\cdot(d_{j}t-d_{t})+S_{p}
```
- 当该品类蔬菜实际销量小于订货量
 ![[Pasted image 20250113142526.png]]
 ```latex
 G\cdot(d_{j}t-d_{t})+S_{p} \leq x \leq 160\%S_{p}
```

#### 构建遗传算法求解
基于[遗传算法进行仿真实验](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=CUMCM%2FCUMCM%20%E4%BB%A3%E7%A0%81%2F%E8%94%AC%E8%8F%9C%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C)，我们使用第一天的数据进行实验，通过需求不确定集，我们可以模拟出当天的实际销量，将第一天的数据运行100次，我们就得到了第一天实际销量的100种可能,进而得到100次第一天销量的的最佳定价，通过求取平均值的方式得到可能的最佳定价，结果储存在"2023c\第二问\第二小问\定价与利润.xlsx"，为了节省时间，我只运行了第一天的结果。
![[最佳利润.png]]
### 模型检验
由于我们在仿真实验中使用了遗传算法，同时构建了需求不确定集，为了验证模型的稳定性，我们将上述模型运行20次，以检验其鲁棒性。设定上下有效区间为20%，远远高出鲁棒性有效检验的最低要求。
![[鲁棒性检验.png]]
可以发现，在模拟第一天50次的情况下，运行20次的结果都在有效区间内，且我们计算出其方差为2.85992，这说明我们的模型具有良好的鲁棒性，即在不确定变量的情况下模型的稳定性良好，因此我们认为它具有实用价值。

>[!note] 论文建议
>可以详细阐释一下。






## 四、第三问
对于题中要求，我们需要找到适合在7月1日~7日销售的单品27~33种，我们使用[‘***topsis***'](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=%E5%BB%BA%E6%A8%A1%2F%E5%9F%BA%E6%9C%AC%E7%AE%97%E6%B3%95%2Ftopsis%E6%B3%95)法对其他年份在同时期销售的蔬菜进行评价，找出适合销售的27种单品，并通过第二问使用模型进行求解。
### Topsis法
通过对同时期销售的蔬菜进行分析，我们使用最高定价、平均定价、平均销量、最大销量、平均成本，这五个数据作为评价指标，得出了27种蔬菜，其结果存储在"2023c\第三问\求解\评价结果.xlsx"
([代码](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=CUMCM%2FCUMCM%20%E4%BB%A3%E7%A0%81%2F%E8%94%AC%E8%8F%9Ctopsis))
>[!note] 论文建议
>可以讲述一下Topsis法的原理。

### 模型求解
与第二问相同，我将结果存储于"2023c\第三问\求解\评价结果.xlsx"，[代码](obsidian://open?vault=%E9%AD%94%E6%96%B9&file=CUMCM%2FCUMCM%20%E4%BB%A3%E7%A0%81%2F%E8%94%AC%E8%8F%9C%E7%AC%AC%E4%B8%89%E9%97%AE%E4%BB%A3%E7%A0%81)


## 五、第四问

语文建模，合理即可