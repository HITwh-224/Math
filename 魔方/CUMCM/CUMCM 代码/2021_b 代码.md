## 第一问
```
clear,clc

folder_path = 'C:\Users\15855\Desktop\2025-冬-建模练习\25_2_8_2021b\第一问\第一小问\01- 皮尔逊相关系数检验线性关系\皮尔曼检验所需数据.xlsx';

data = readmatrix(folder_path);

PER = [];

DA_P = [];

for i = 1:4:length(data)

if i+2 <= length(data)

x1 = data(1:7, i);

x2 = data(1:7, i+1)';

x3 = data(1:7, i+2)';

% 处理NaN值

x1 = rmmissing(x1);

x2 = rmmissing(x2);

x3 = rmmissing(x3);

[R, P] = corrcoef(x1, x2);

[R2, P2] = corrcoef(x1, x3);

PER = [PER; R(1,2), R2(1,2)];

DA_P = [DA_P; P(1,2), P2(1,2)];

end

end
```

```
function [fitresult, gof] = createFit(x1, x2)

%CREATEFIT(X1,X2)

% 创建一个拟合。

%

% 要进行 '无标题拟合 1' 拟合的数据:

% X 输入: x1

% Y 输出: x2

% 输出:

% fitresult: 表示拟合的拟合对象。

% gof: 带有拟合优度信息的结构体。

%

% 另请参阅 FIT, CFIT, SFIT.

% 由 MATLAB 于 08-Feb-2025 11:27:13 自动生成

%% 拟合: '无标题拟合 1'。

[xData, yData] = prepareCurveData( x1, x2 );

% 设置 fittype 和选项。

ft = fittype( 'exp1' );

opts = fitoptions( 'Method', 'NonlinearLeastSquares' );

opts.Display = 'Off';

opts.StartPoint = [0.0517820047262646 0.0180515356983074];

% 对数据进行模型拟合。

[fitresult, gof] = fit( xData, yData, ft, opts );

% 为绘图创建一个图窗。

figure( 'Name', '无标题拟合 1' );

% 绘制数据拟合图。

subplot( 2, 1, 1 );

h = plot( fitresult, xData, yData );

legend( h, 'x2 vs. x1', '无标题拟合 1', 'Location', 'NorthEast', 'Interpreter', 'none' );

% 为坐标区加标签

xlabel( 'x1', 'Interpreter', 'none' );

ylabel( 'x2', 'Interpreter', 'none' );

grid on

% 绘制残差图。

subplot( 2, 1, 2 );

h = plot( fitresult, xData, yData, 'residuals' );

legend( h, '无标题拟合 1 - 残差', 'Zero Line', 'Location', 'NorthEast', 'Interpreter', 'none' );

% 为坐标区加标签

xlabel( 'x1', 'Interpreter', 'none' );

ylabel( 'x2', 'Interpreter', 'none' );

grid on
```

```
clear,clc

folder_path = 'C:\Users\15855\Desktop\2025-冬-建模练习\25_2_8_2021b\第一问\第一小问\01- 皮尔逊相关系数检验线性关系\皮尔曼检验所需数据.xlsx';

data = readmatrix(folder_path);

i = 13;

x1 = data(1:7, i);

x2 = data(1:7, i+1);

x3 = data(1:7, i+2);

x1 = rmmissing(x1);

x2 = rmmissing(x2);

x3 = rmmissing(x3);

[fitresult, gof] = createFit(x1, x2)
```

```
clear,clc

folder_path = 'C:\Users\15855\Desktop\2025-冬-建模练习\25_2_8_2021b\第一问\第二小问\基础数据.xlsx';

data = readmatrix(folder_path);

C4 = data(:,2)';

YI = data(:,8)';

ZH = data(:,9)';

T = data(:,7);

plot(T,C4,'-b',T,YI,'-r');

legend('C4选择性','乙醇转化率');

xlabel('时间（s）');

ylabel('比率（%）');
```

 ## 第三问
 ```
 clear,clc

read_file = 'C:\Users\15855\Desktop\2025-冬-建模练习\25_2_8_2021b\第三问\基础数据.xlsx';

data = readmatrix(read_file);

Co = data(:,1);

Co_SIO2 = data(:,2);

HAP = data(:,3);

Heat = data(:,4);

Eth_CON = data(:,5);

y = data(:,12);

X = data(:,1:5);
```

```
% Solve an Input-Output Fitting problem with a Neural Network

% Script generated by Neural Fitting app

% Created 10-Feb-2025 12:03:18

%

% This script assumes these variables are defined:

%

% X - input data.

% y - target data.

x = X';

t = y';

% Choose a Training Function

% For a list of all training functions type: help nntrain

% 'trainlm' is usually fastest.

% 'trainbr' takes longer but may be better for challenging problems.

% 'trainscg' uses less memory. Suitable in low memory situations.

trainFcn = 'trainbr'; % Bayesian Regularization backpropagation.

% Create a Fitting Network

hiddenLayerSize = 10;

net = fitnet(hiddenLayerSize,trainFcn);

% Choose Input and Output Pre/Post-Processing Functions

% For a list of all processing functions type: help nnprocess

net.input.processFcns = {'removeconstantrows','mapminmax'};

net.output.processFcns = {'removeconstantrows','mapminmax'};

% Setup Division of Data for Training, Validation, Testing

% For a list of all data division functions type: help nndivision

net.divideFcn = 'dividerand'; % Divide data randomly

net.divideMode = 'sample'; % Divide up every sample

net.divideParam.trainRatio = 70/100;

net.divideParam.valRatio = 15/100;

net.divideParam.testRatio = 15/100;

% Choose a Performance Function

% For a list of all performance functions type: help nnperformance

net.performFcn = 'mse'; % 均方误差

% Choose Plot Functions

% For a list of all plot functions type: help nnplot

net.plotFcns = {'plotperform','plottrainstate','ploterrhist', ...

'plotregression', 'plotfit'};

% Train the Network

[net,tr] = train(net,x,t);

% Test the Network

y = net(x);

e = gsubtract(t,y);

performance = perform(net,t,y)

% Recalculate Training, Validation and Test Performance

trainTargets = t .* tr.trainMask{1};

valTargets = t .* tr.valMask{1};

testTargets = t .* tr.testMask{1};

trainPerformance = perform(net,trainTargets,y)

valPerformance = perform(net,valTargets,y)

testPerformance = perform(net,testTargets,y)

% View the Network

view(net)

% Plots

% Uncomment these lines to enable various plots.

%figure, plotperform(tr)

%figure, plottrainstate(tr)

%figure, ploterrhist(e)

%figure, plotregression(t,y)

%figure, plotfit(net,x,t)

% Deployment

% Change the (false) values to (true) to enable the following code blocks.

% See the help for each generation function for more information.

if (false)

% Generate MATLAB function for neural network for application

% deployment in MATLAB scripts or with MATLAB Compiler and Builder

% tools, or simply to examine the calculations your trained neural

% network performs.

genFunction(net,'myNeuralNetworkFunction');

y = myNeuralNetworkFunction(x);

end

if (false)

% Generate a matrix-only MATLAB function for neural network code

% generation with MATLAB Coder tools.

genFunction(net,'myNeuralNetworkFunction','MatrixOnly','yes');

y = myNeuralNetworkFunction(x);

end

if (false)

% Generate a Simulink diagram for simulation or deployment with.

% Simulink Coder tools.

gensim(net);

end
```

```
  

Co = [0.01 0.02 0.005 0.05 ];

Co_Sio22 = [200 50 67 33 100 10 25 75 ];

HAP1 = [200 50 90 33 67 10 25 75 100];

Heat1 = [250 275 300 325 350 375 400 425 450];

YC = [1.68 0.9 0.3 2.1 ];

X1 = [];

for i = 1:4

for j = 1:8

for k = 1:9

for r = 1:9

for s = 1:4

X1 = [X1;Co(1,i) Co_Sio22(1,j), HAP1(1,k),Heat1(1,r),YC(1,s)];

end

end

end

end

end

C1 = X1';

Z = results_2.Network(C1);

Z = Z';
```
 