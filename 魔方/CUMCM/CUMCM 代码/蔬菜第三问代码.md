```
clear,clc

file_path = 'C:\Users\15855\Desktop\2023c\第三问\求解\评价结果.xlsx';

data = readmatrix(file_path);

data_sell = data(:,2:8)';

%%数据处理

tem_var01 = zeros(1,27);%创建零矩阵，用于01变量设置

pre_val = data(1:7,1:27);%七天预测蔬菜销售量

err_var = 0.3 * pre_val;%偏差函数

nor_val = pre_val + normrnd(0,0.5,[7,27]) .* err_var;%需求不确定集（偏差函数使用方差为0.5，均值为0的正态函数表示概率）

cst = [3.57579646 10.73553385 3.402571429 8.254772102 2.536213884...

2.45877551 4.757260274 1.523417722 2.149 3.220553041 8.9876 18 ...

1.953387097 3.73035836 12.99071429 3.366659775 2.323930453 9.635608504 ...

4.134897959 9.167540085 7.561729753 3.32835443 7.762256098 15.6 1.453362832 ...

6.986551724 11.55087775 ];%蔬菜平均成本

gra1 = [0.09 0.09 0.03 0.06 0.04 0.05 0.09 0.03 0.05 0.09 0.06 0.05 0.04 0.03 0.05 ...

0.09 0.09 0.03 0.06 0.04 0.05 0.09 0.03 0.05 0.09 0.06 0.05];%销量与售价的梯度关系

%%构建01变量

tem_var01 (1,nor_val(1,:) >= pre_val(1,:)) = 1;%寻找实际销量大于预计销量的值，赋值为1

tem_var_sm = pre_val(1,:) - nor_val(1,:);

lim = -tem_var_sm .* gra1 + cst;%计算蔬菜全部卖光需要的价格，设置为变量下限

%%构建决策变量，对于降价销售蔬菜，设置上限为成本的160%，对于加价蔬菜，设置上限为全部卖光所需价格

UB = lim.*tem_var01 + cst*1.6.*(1-tem_var01);%决策变量

options = optimoptions('ga', 'Display', 'iter'); % 遗传算法选项

[x,y] = ga(@(x)obj(x,nor_val),27,[],[],[],[],lim,UB,[],options);%调用ga函数，设置遗传算法求解

% 输出优化结果

disp('Optimized variables:');

disp(x);

disp('Objective function value:');

disp(-y);

  

  

  

%%预设函数

function y = obj(x,m)

%需要的随机量，即不确定集得出的实际销量

cost = [3.57579646 10.73553385 3.402571429 8.254772102 2.536213884...

2.45877551 4.757260274 1.523417722 2.149 3.220553041 8.9876 18 ...

1.953387097 3.73035836 12.99071429 3.366659775 2.323930453 9.635608504 ...

4.134897959 9.167540085 7.561729753 3.32835443 7.762256098 15.6 1.453362832 ...

6.986551724 11.55087775 ];

pre_sell = [36.9643998200000 7.08863126800000 11.6627508600000 2.97846026500000 9.03468441700000 8.54469854500000 12.2516743000000 13.3250807300000 25.6934074700000 7.01071502900000 6.26536611400000 4.70533333300000 10.3299232700000 12.8412603700000 2.38466545200000 16.1091898400000 10.3733739300000 1.36083764800000 12.2206148300000 2.44710839700000 7.81406103100000 13.4384920600000 15.0796323600000 5.39483333300000 18.8211009200000 4.83953266600000 3.48849267700000];

gra = [0.09 0.09 0.03 0.06 0.04 0.05 0.09 0.03 0.05 0.09 0.06 0.05 0.04 0.03 0.05 ...

0.09 0.09 0.03 0.06 0.04 0.05 0.09 0.03 0.05 0.09 0.06 0.05];

y =x*(((cost' - x')./gra') + m(1,:)') - cost*pre_sell';

y = -y;

end
```